
<!doctype html>
<html lang="ar" dir="auto">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Copy Prompt</title>
  <style>
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial;background:#0f172a;color:#fff;
         display:flex;min-height:100vh;align-items:center;justify-content:center;padding:16px}
    .card{width:min(800px,96vw);background:#1e293b;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,.6);
          padding:24px;text-align:center}
    h1{margin:0 0 16px;font-size:clamp(22px,4vw,28px)}
    .btn{display:inline-block;padding:16px 22px;border-radius:14px;border:0;font-weight:800;
         font-size:clamp(18px,4.5vw,22px);cursor:pointer;background:#ffd04d;color:#000}
    .btn:active{transform:scale(.98)}
    .hint{margin-top:14px;opacity:.9;font-size:16px}
    textarea{position:absolute;left:-9999px;top:-9999px}
  </style>
</head>
<body>
  <div class="card">
    <h1 id="title">Copy Prompt</h1>
    <button class="btn" id="copyBtn">نسخ البرومبت</button>
    <div class="hint" id="hint">جارٍ التحميل...</div>
    <textarea id="ta" readonly></textarea>
  </div>
  <script>
    const BASE_EXEC = "https://script.google.com/macros/s/AKfycbyu4WO5D0W-ft1mP3JnWHjIRYzGfmE3wIjjRZUiKZ5bVbPe5-tGIx2k_UvsxRO7sIf1/exec";
    const qs = new URLSearchParams(location.search);
    const rk = qs.get("rk") || "";
    const t  = decodeURIComponent(qs.get("t") || "");
    if(t) document.getElementById("title").textContent = t;

    async function load(){
      if(!rk){ document.getElementById("hint").textContent = "⚠️ Missing rk"; return; }
      try {
        const url = `${BASE_EXEC}?rk=${encodeURIComponent(rk)}&json=1`;
        const res = await fetch(url, {mode:"cors"});
        if(!res.ok) throw new Error("network");
        const data = await res.json();
        window.__PROMPT__ = data.prompt || "";
        document.getElementById("hint").textContent = data.howto || "جاهز للنسخ ✅";
      } catch(e){
        document.getElementById("hint").textContent = "⚠️ تعذر جلب البيانات";
      }
    }
    load();

    document.getElementById("copyBtn").onclick = async () => {
      try {
        const text = window.__PROMPT__ || "";
        const ta = document.getElementById("ta");
        ta.value = text; ta.select(); ta.setSelectionRange(0, ta.value.length);
        let ok = false;
        try { ok = document.execCommand("copy"); }catch{}
        if (!ok && navigator.clipboard){ await navigator.clipboard.writeText(text); ok = true; }
        document.getElementById("hint").textContent = ok ? "تم النسخ ✅" : "انسخ يدويًا";
      }catch{ document.getElementById("hint").textContent = "انسخ يدويًا"; }
    };
  </script>
</body>
</html>
